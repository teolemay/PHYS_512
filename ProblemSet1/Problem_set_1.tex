\documentclass{article}

%opening
\title{PHYS 512 Problem set 1}
\author{Teophile Lemay, 281081252}
\date{}
\usepackage[left=2cm, right=2cm, top=2cm, bottom=2cm]{geometry}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{physics}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{xcolor}
\newcommand{\<}[1]{\left\langle #1 \right\rangle }


\begin{document}
	\maketitle
	
\section{}
Given a function $f$, evaluated at the points $x\pm\delta$ and $x\pm2\delta$.

\subsection{a)}
The derivative at $x$ can be calculated from the points around $x$ using the central derivative formula (in the limit of small $\delta$):
\[f'(x) = \frac{f(x+\delta) - f(x-\delta)}{2\delta}\]
Performing a Taylor expansion of $f$ at each point gives
\[f(x+\delta) \approx f(x) + f'(x)\delta + \frac{1}{2}f''(x)\delta^2 + \frac{1}{6}f'''(x)\delta^3 + \frac{1}{24}f''''(x)\delta^4 + \frac{1}{120}f'''''(x)\delta^5 + ...\]
\[f(x-\delta) \approx f(x) - f'(x)\delta + \frac{1}{2}f''(x)\delta^2 - \frac{1}{6}f'''(x)\delta^3 + \frac{1}{24}f''''(x)\delta^4 - \frac{1}{120}f'''''(x)\delta^5 + ...\]
\[f(x+2\delta) \approx f(x) + f'(x)2\delta + 2f''(x)\delta^2 + \frac{4}{3}f'''(x)\delta^3 + \frac{2}{3}f''''(x)\delta^4 + \frac{4}{15}f'''''(x)\delta^5 + ...\]
\[f(x-2\delta) \approx f(x) - f'(x)2\delta + 2f''(x)\delta^2 - \frac{4}{3}f'''(x)\delta^3 + \frac{2}{3}f''''(x)\delta^4 - \frac{4}{15}f'''''(x)\delta^5 + ...\]
For the $x\pm\delta$ case, subtracting $f(x-\delta)$ from $f(x+\delta)$ gives the central derivative:
\[f(x+\delta) - f(x-\delta) = 2f'(x)\delta +\frac{1}{3}f'''(x)\delta^3 + \frac{1}{60}f'''''(x)\delta^5 + ...\]
\[f'(x) = \frac{f(x+\delta) - f(x-\delta)}{2\delta}-  \frac{1}{6}f'''(x)\delta^2 - \frac{1}{120}f'''''(x)\delta^4 + ... \]
Performing the same operation on the $x\pm2\delta$ case:
\[f'(x) = \frac{f(x+2\delta) - f(x-2\delta)}{4\delta} - \frac{2}{3}f'''(x)\delta^2 - \frac{2}{15}f'''''(x)\delta^4 - ...\]
The $\delta^2$ term can be eliminated by subtracting four times the $x\pm\delta$ derivative from the $x\pm2\delta$ derivative
\begin{multline*}
	f'(x) - 4f'(x) = \left(\frac{f(x+2\delta) - f(x-2\delta)}{4\delta} - \frac{2}{3}f'''(x)\delta^2 - \frac{2}{15}f'''''(x)\delta^4 - ...\right) - \\
	4\left(\frac{f(x+\delta) - f(x-\delta)}{2\delta}-  \frac{1}{6}f'''(x)\delta^2 - \frac{1}{120}f'''''(x)\delta^4 + ...\right)
\end{multline*}
\[-3f'(x) = \frac{8f(x-\delta) + f(x+2\delta) - 8f(x+\delta) - f(x-\delta)}{4\delta} - \frac{1}{10}f'''''(x)\delta^4\]
\[\boxed{ f'(x) = \frac{8f(x+\delta) - 8f(x-\delta) + f(x-\delta) - f(x+2\delta)}{12\delta} + \frac{1}{30}f'''''(x)\delta^4 + ... }\]

\subsection{b)}
The error for this derivative is comes from rounding error and discarding higher order terms from the Taylor series. For rounding error $\epsilon$, the error is approximately 
\[\text{error } = \frac{|f(x)|\cdot\epsilon}{\delta} + \frac{1}{30}f'''''(x)\delta^4 \text{.}\]
Minimizing with respect to $\delta$:
\[0 = \dv{}{\delta}\left( \frac{|f(x)|\cdot\epsilon}{\delta} + \frac{1}{30}f'''''(x)\delta^4 \right) = -\frac{|f(x)|\cdot \epsilon}{\delta^2} + \frac{2}{15}f'''''(x)\delta^3\]
\[\frac{|f(x)|\cdot \epsilon}{\delta^2} = \frac{2}{15}f'''''(x)\delta^3\]
\[\delta^5 = \frac{15}{2}\frac{|f(x)|\cdot \epsilon}{f'''''(x)}\]
So the ideal value of $\delta$ should be 
\[\boxed{ \delta = \left(\frac{15}{2}\frac{|f(x)|\cdot \epsilon}{f'''''(x)}\right)^{1/5} }\text{ .}\]

\section{}






\end{document}
